from random import choice
from requests import get
import json
def api_showing_movie():
    '''()->str
    function uses an imdb api
    using imdb url and the genre desired , with a limit to no. of results
    returns movie name from requested genre
    '''
    url = "https://imdb8.p.rapidapi.com/title/v2/get-popular-movies-by-genre"
    querystring = {"genre":mood}
    headers = {
	"X-RapidAPI-Key": "ffd44556camsh3a5b802bb586f56p10f759jsn6c25ffadb53b",
	"X-RapidAPI-Host": "imdb8.p.rapidapi.com"
    }
    movies=get(url, headers=headers, params=querystring)
    try :
        assert movies.status_code==200
        return(movies)
    except AssertionError:
        print("Error with API,try again later :)")
        return None
 
def movie_title():
    ID = random_movie[7:-1]
    API_KEY='6bf7ef52'
    movie_info=get('http://www.omdbapi.com/?apikey='+API_KEY+'&i='+ID).json()
    return (movie_info)

mood=[
    'romance' ,'mystery' ,'drama' ,
    'adventure' ,'sci-fi ','action' ,
    'comedy' ,'thriller ', 'horror','animation',
    'biography','crime','documentary',
    'family','fantasy','history',
    'music','musical','sports','war'
]
choose = input('would you like to randomize your genre? ').lower()

if choose == 'yes':
    mood_chosen=choice(mood)
    print('your chosen genre is:',mood_chosen)
    url = "https://imdb8.p.rapidapi.com/title/v2/get-popular-movies-by-genre"
    querystring = {"genre":mood_chosen}
    headers = {
	"X-RapidAPI-Key": "ffd44556camsh3a5b802bb586f56p10f759jsn6c25ffadb53b",
	"X-RapidAPI-Host": "imdb8.p.rapidapi.com"
    }
    movies = get(url, headers=headers, params=querystring)
    random_movie = choice(movies.json())
    movie_details=json.dumps(movie_title(),indent=1)
    print(movie_details,'\n')
    
else:
    mood = input ('choose your genre: romance ,mystery ,drama ,adventure ,'
    'sci-fi ,action ,comedy ,thriller ,animation\n,biography ,family ,crime '
    ',documentary ,fantasy ,history ,msuic ,musical ,sports ,war or horror: ').lower()
    movies=api_showing_movie()
    random_movie=choice(movies.json())
    movie_details=json.dumps(movie_title(),indent=1)
    print(movie_details,'\n') 
